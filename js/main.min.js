Adventure={story:"",container:$("#description"),form:$("#input-form"),input:$("#text-input"),$customForm:$("#custom-form-container"),$focus:null,$mainContainer:$("#main-container"),currentPlace:null,save:{},init:function(t,e){var o=this;o.story=t,$(window).on("click",function(t){"[object HTMLInputElement]"!==t.target.toString()&&o.$focus.focus()}),o.form.submit(function(t){t.preventDefault(),o.listen(o.input.val())}),o.go(e)},clean:function(){var t=this;t.input.val(""),t.$customForm.html(""),t.$mainContainer.removeClass().addClass("container")},go:function(t,e){var o=this;if(o.say(o.input.val().toUpperCase(),e),o.clean(),o.currentPlace=o.story[t],_.has(o.currentPlace,"type"))switch(o.currentPlace.type){case"conversation":o.chat();break;case"question":o.question()}else o.$focus=o.input,o.say(o.currentPlace.description);o.$focus.focus()},listen:function(t){var e=this;t=t.toLowerCase();for(var o=t.split(" "),n=_.keys(e.currentPlace.actions),i=0;i<o.length;i++){var a=o[i];if("list"===a){for(var r="<p>From here you can say:</p><ul>",s=0;s<n.length;s++)r+='<li class="list-option">'+n[s].toUpperCase()+"</li>";r+="</ul>",e.clean(),e.say(r);break}if("help"!==a){if(_.indexOf(n,a)>=0){e.go(e.currentPlace.actions[a],!0);break}_.indexOf(n,"default")>=0?e.go(e.currentPlace.actions["default"],!0):""===a?e.clean():(e.say(a.toUpperCase(),!0),e.say("action not found"),e.clean());break}e.say("============HELP");var c="<p>You can move around and interact with this world by typing commands when prompted with the cursor and then pressing ENTER.</p><p>When you enter a new position on the map a description of that position is read to you. The available commands for that position will be in upper case letters.</p><p>Directional commands like EAST or SOUTHEAST will move you to a new position. Object commands like PAINTING or VIDEO will tell you about an object in the world.</p><p>...</p><p>Sometimes a person will start a conversation with you. When it is time to speak back you will be given a list of responses like:</p><p>>&nbsp;Yes<br>&nbsp;&nbsp;No</p><p>You can choose a response with the UP and DOWN arrow keys, and press RETURN or ENTER to select it.</p><p>...</p><p>Also there are commands you can use at any time to help you on your way:</p><p>Type LIST to see a list of possible commands from your current position.</p><p>Type HELP to see this information again.</p><p>...</p><p>You current position is "+e.currentPlace.name+"</p>";e.say(c),e.say(e.currentPlace.description),e.clean()}},say:function(t,e){var o=this,n=/\{\{.*\}\}/,i=t.match(n);if(i){var a=i[0].substr(0,i[0].length-2).substr(2);t=t.replace(n,o.save[a])}e&&(t="> "+t),t="<p>"+t+"</p>",t=t.replace(/\n/g,"<br />"),o.container.append(t),window.scrollTo(0,document.body.scrollHeight)},chat:function(t){var e=this;t="undefined"!=typeof t?e.story[t].options:e.currentPlace.options;for(var o='<form id="custom-form">',n=1;n<=_.size(t);n++){var i=1===n?"checked":"";o+='<input id="radio-'+n+'" type="radio" name="conversation" value="'+n+'" '+i+' /><label for="radio-'+n+'"> '+t[n]+"</label><br />"}o+='<input type="submit" value="Submit"></form>',e.$customForm.html(o),e.$customForm=$("#custom-form-container"),e.say(e.currentPlace.description),e.$mainContainer.addClass("conversation"),e.$focus=$("#radio-1"),e.$customForm.find("#custom-form").bind("submit",function(t){t.preventDefault();var o=$('input[type="radio"]:checked').val();if(""===o)return!1;var n=e.currentPlace.actions[o];e.say(e.currentPlace.options[o].toUpperCase(),!0),e.go(n)}),$(".touch").length&&e.$customForm.find('input[type="radio"][name="conversation"]').change(function(t){e.$customForm.find("#custom-form").submit()})},question:function(t){var e=this,o="undefined"!=typeof t?e.story[t].save:e.currentPlace.save,n='<form id="custom-form" autocomplete="off"><div id="text-input-holder"><input id="question-input" type="text" autocomplete="off"></div><input type="submit" value="Submit"></form>';e.$customForm.html(n),e.$customForm=$("#custom-form-container"),e.say(e.currentPlace.description),e.$mainContainer.addClass("question"),e.$focus=$("#question-input"),e.$customForm.find("#custom-form").bind("submit",function(t){t.preventDefault();var n=$("#question-input").val();return""!==n&&(e.save[o]=n.toUpperCase(),e.say(n.toUpperCase(),!0),void e.go(e.currentPlace.actions["default"],!1))})},placeExist:function(t){var e=this;return"object"==typeof e.story[t]}},$(document).ready(function(){"use strict";Adventure.init(Story,"welcome")}),$(window).load(function(){});
//# sourceMappingURL=main.min.js.map
