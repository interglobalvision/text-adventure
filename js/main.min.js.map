{"version":3,"sources":["main.js"],"names":["Adventure","story","container","$","form","input","$customForm","$focus","command","$mainContainer","currentPlace","init","place","_this","this","window","on","keyup","text","val","submit","event","preventDefault","listen","go","clean","html","removeClass","addClass","say","toUpperCase","placeExist","_","has","type","chat","description","focus","toLowerCase","words","split","actions","keys","i","length","action","help","x","indexOf","replace","append","scrollTo","document","body","scrollHeight","conversation","options","chatForm","ffs","size","checked","children","bind","selectedOption","nextPlace","ready","Story","load"],"mappings":"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","file":"main.min.js","sourcesContent":["/* jshint browser: true, devel: true, indent: 2, curly: true, eqeqeq: true, futurehostile: true, latedef: true, undef: true, unused: true */\n/* global $, document, Adventure, _, Story */\n\nAdventure = {\n  story: '',\n  container: $('#description'),\n  form: $('#input-form'),\n  input: $('#text-input'),\n  $customForm: $('#custom-form-container'),\n  $focus: null,\n  command: $('#command'),\n  $mainContainer: $('#main-container'),\n  currentPlace: null,\n  init: function(story, place) {\n    var _this = this;\n\n    // Set story\n    _this.story = story;\n\n    // Prevent input blur\n    $(window).on('click', function(){\n      //_this.$focus.focus();\n    });\n\n    // Copy from input to \"command line\"\n    _this.input.keyup(function() {\n      _this.command.text( _this.input.val() );\n    });\n\n    // Bind event\n    _this.form.submit( function(event) {\n      event.preventDefault();\n      _this.listen( _this.input.val() );\n    });\n\n    _this.go(place);\n  },\n\n  clean: function() {\n    var _this = this;\n\n    _this.input.val('');\n    _this.command.text('');\n    _this.$customForm.html('');\n    _this.$mainContainer.removeClass().addClass('container');\n\n  },\n\n  go: function(place) {\n    var _this = this;\n\n    // Output command\n    _this.say(_this.command.text().toUpperCase());\n\n    // Clear input and \"command line\"\n    _this.clean();\n\n    // Check if action exists\n    if (_this.placeExist(place)) {\n\n      // Set new place\n      _this.currentPlace = _this.story[place];\n\n      // Check if place is not a special type ex. conversation, question \n      if( !_.has(_this.currentPlace, 'type') ) {\n        // Set focus element\n        _this.$focus = _this.input;\n\n        // Print description\n        _this.say(_this.currentPlace.description);\n\n      // else is special type\n      } else {\n        switch(_this.currentPlace.type) {\n          case 'conversation': {\n            _this.chat();\n            break;\n          }\n\n          case 'question': {\n            break;\n          }\n\n        }\n      }\n\n    } else {\n      // Action not found\n      _this.say('Action not found');\n    }\n\n    // focus \n    _this.$focus.focus();\n  },\n\n  listen: function(text) {\n    var _this = this;\n\n    // Convert to lowercase\n    text = text.toLowerCase();\n\n    // Split text into words in case theres more than just one word\n    var words = text.split(' ');\n\n    // Get an array of all available actions\n    var actions = _.keys(_this.currentPlace.actions);\n\n    for (var i = 0; i < words.length; i++) {\n      var action = words[i];\n\n      // if 'help'\n      if (action === 'help') {\n\n        var help = '<p>From here you can say:</p><ul>';\n\n        for (var x = 0; x < actions.length; x++) {\n          actions[x].toUpperCase();\n          help += '<li>' + actions[x] + '</li>';\n        }\n\n        help += '</ul>';\n        _this.say(help);\n        break;\n\n      // Check if action exists\n      } else if (_.indexOf(actions,action) >= 0) {\n\n        _this.go(_this.currentPlace.actions[action]);\n        break;\n\n      // Action not found\n      } else {\n\n        // Check for default action\n        if (_.indexOf(actions, 'default') >= 0) {\n          _this.go( _this.currentPlace.actions.default);\n        } else {\n          _this.say('action not found');\n        }\n\n        break;\n\n      }\n    }\n  },\n\n  say: function(text) {\n    var _this = this;\n\n    text = '<p>' + text + '</p>';\n    text = text.replace(/\\n/g, '</p><p>');\n    _this.container.append(text);\n\n    window.scrollTo(0,document.body.scrollHeight);\n  },\n\n  chat: function(conversation) {\n    var _this = this;\n\n    // Get the conversation\n    conversation = typeof conversation !== 'undefined' ? _this.story[conversation].options : _this.currentPlace.options;\n\n    var chatForm = '<form id=\"custom-form\">';\n\n    // Generate radio buttons \n    for(var ffs = 1; ffs <= _.size(conversation); ffs++) {\n      var checked = ffs === 1 ? 'checked' : '';\n\n      chatForm += '<input id=\"radio-' + ffs + '\" type=\"radio\" name=\"conversation\" value=\"' + ffs + '\" ' + checked + ' /><label for=\"radio-' + ffs + '\">' + conversation[ffs] + '</label><br />';\n    }\n\n    // Add submit button\n    chatForm += '<input type=\"submit\" value=\"Submit\"></form>';\n\n    // insert dom and container class\n    _this.$customForm.html(chatForm);\n    _this.$customForm = $('#custom-form-container');\n    _this.say(_this.currentPlace.description);\n    _this.$mainContainer.addClass('conversation');\n\n    // Set new focus element\n    _this.$focus = $('#radio-1');\n\n    // Bind submit\n    _this.$customForm.children().bind('submit', function(event) {\n      event.preventDefault();\n      var selectedOption = $('input[type=\"radio\"]:checked').val();\n      var nextPlace = _this.currentPlace.actions[selectedOption];\n\n      _this.say(_this.currentPlace.options[selectedOption].toUpperCase());\n      _this.go(nextPlace);\n    });\n\n  }, \n\n  placeExist: function(place) {\n    var _this = this;\n\n    if (typeof( _this.story[place] ) === 'object') {\n      return true;\n    } else {\n      return false;\n    }\n  },\n\n};\n$(document).ready(function () {\n  'use strict';\n  Adventure.init(Story, 'welcome');\n});\n\n$(window).load(function () {\n});\n"],"sourceRoot":"/source/"}